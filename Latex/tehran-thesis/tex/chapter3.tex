\chapter{تخصیص منابع در شبکه های \lr{Open RAN}}
در این فصل، هدف تخصیص منابع در شبکه های \lr{Open RAN} در لینک فروسو می باشد که شامل تخصیص توان و برش های شبکه است.
در این بخش فرض بر این است که شبکه ی نسل پنجم مخابرات با زیرساخت \lr{Open RAN} موجود است. این شبکه سرویس هایی از قبیل \lr{IoT}، سرویس تلفن، پیامک و ... در اختیار کاربران قرار می دهد. در اینجا از مفهوم برش شبکه استفاده شده است بدین صورت که به جای دیدن کاربران به صورت مجزا، کاربرانی که از یک سرویس خاص استفاده می نمایند در دسته ی آن سرویس قرار گرفته و دسته بندی می شوند. همچنین برش هایی از شبکه در اختیار کاربران هر سرویس خاص، قرار می گیرد که هر برش شبکه شامل تعدادی واحد رادیویی
\LTRfootnote{Radio Unit}
(\lr{RU}) 
،
بلوک های منبع فیزیکی
 \LTRfootnote{Physical Resource Block}
 (\lr{PRB})، 
 یک واحد توزیع شده
\LTRfootnote{Distributed Unit}
(\lr{DU}) 
 ، 
 یک واحد مرکزی
\LTRfootnote{Centralized Unit}
(\lr{CU})  
  می باشد که هر واحد توزیع شده و مرکزی شامل تعدادی توابع شبکه ی مجازی شده
  \LTRfootnote{Virtual Network Function}
(\lr{VNF}) 
می باشد. 
\section{مدل سیستم}
در این قسمت، سیستم مدل به صورت کامل مورد بررسی قرار می گیرد.
فرض می کنیم $S$ برش شبکه داریم که قرار است $V$ سرویس مختلف که شامل کاربرانی است که از سرویس خاص استفاده می نمایند را سرویس دهی نماید.
هر سرویس 
$v\in \{1,2,...,V \} $
شامل 
$U_v$
کاربر تک آنتنه می باشند که از سرویس خاصی را درخواست می نماید.
هر برش شبکه 
$s \in \{1,2,...,S \}$
شامل 
$R_s$
واحد رادیویی،
$K_s$
بلوک های منابع فیزیکی، یک واد توزیع شده و یک واحد مرکزی که شامل \lr{VNF} هایی می باشند.
همچنین برش های شبکه می توانند منابع مشترک داشته باشند.
تمام \lr{RU}هایی که به یک سرویس خاص خدمت رسانی می کنند به صورت مشارکتی سیگنال به تمام کاربران در آن سرویس ارسال می نمایند. 
\cite{motalleb2017optimal,mimoCran}
هر واحد رادیویی
$r \in \{1,2,...,R \}$
به یک واحد توزیع شده از طریق لینک فیبر نوری با ظرفیت \lr{fronthaul} 
محدود متصل می باشد.
در سیستم \lr{Open RAN}
دو لایه ی پردازشی که اولی در \lr{CU} و دومی در \lr{DU} قرار گرفته است که پردازش ها با \lr{VNF} ها صورت می گیرد.
لایه پایین تر (\lr{DU}) شامل 
\lr{high-PHY}
،
\lr{MAC}
و 
\lr{RLC}
می باشد و 
لایه ی بالاتر 
(\lr{CU})
شامل 
\lr{RRC}
،
\lr{PDCP}
و 
\lr{SDAP}
است.
فرض بر این است که $M_1$
\lr{VNF}
در \lr{DU}
و 
$M_2$
\lr{VNF}
در \lr{CU} قرار دارد.
هر \lr{VNF} به یک برش یا بیشتر تعلق دارد.
در $s^{th}$ امین برش شبکه $M_{s,1}$ 
\lr{VNF}
در \lr{DU}
و 
$M_{s,2}$
\lr{VNF}
دپر لایه ی \lr{CU} می باشد.
\lr{VNF}
های موجود در لایه ی \lr{DU} و \lr{VU} به ترتیب دارای ظرفیت محاسباتی 
$\mu_1$ 
و
 $\mu_2$
می باشند.
\subsection{نرخ قابل دسترس}
نرخ قابل دسترس برای $i^{th}$ امین کاربر در $v^{th}$امین سرویس به صورت زیر نوشته می شود
\begin{equation}\label{eq1}
\mathcal{R}_{u(v,i)} = B \log_2({1+ \rho_{u(v,i)}}),
\end{equation}
  که $B$ پهنای باند سیستم و 
  $\rho_{u(v,i)}$
  نسبت سیگنال به نویز $i^{th}$
  $i^{th}$ 
  امین کاربر در
   $v^{th}$
   امین سرویس
  می باشد 
  که از رابطه ی زیر بدست می آید
 \begin{equation}\label{eq2}
\rho_{u(v,i)} =  \frac{p_{u(v,i)}\sum_{s=1}^{S}|\bold{h}_{R_s,u(v,i)}^H \bold{w}_{R_s,u(v,i)}|^2 a_{v,s}}{BN_0 + I_{u(v,i)}},
\end{equation}
که   $p_{u(v,i)}$
نشان دهنده ی توان ارسالی توسط \lr{RU} به 
$i^{th}$ 
  امین کاربر در
   $v^{th}$
   امین سرویس
   است و 
 $\bold{h}_{R_s,u(v,i)} \in \mathbb{C}^{{R}_s}$
 بردار کانال گین لینک وایرلس از \lr{RU} ها در 
$s^{th}$
امین برش شبکه می باشد.
 همچنین 
$\bold{w}_{R_s,u(v,i)} \in \mathbb{C}^{{R}_s}$
نشان دهنده ی بردار بیم فرمینگ ارسالی برای \lr{RU}ها در $s$ امین برش شبکه به کاربر $i$ ام در سرویس $v$ ام می باشد.
   به علاوه، $BN_0$
   نشان دهنده ی توان نویز اضافه شونده ی گوسی می باشد و $I_{u(v,i)}$
   توان سیگنال تداخلی است.
همچنین $a_{v,s} \in \{0,1\}$
متغیر باینری است که نشان دهنده ی این است که برش شبکه ی $s$ به سرویس $v$ خدمات رسانی می کند یا نه.
درصورتی که 
 $a_{v,s} =1$
 برش شبکه ی $s$ به سرویس $v$ خدمات رسانی می کند. در غیر این صورت خدمت رسانی نمی کند.
\newline
برای بدست آوردن \lr{SNR} در فرمول \eqref{eq2}، 
فرض می شود که 
 $\bold{y}_{U_v}\in \mathbb{C}^{U_v} $
 بردار سیگنال دریافتی از همه ی کاربران در سرویس $v$ می باشد 
\begin{equation}\label{eq3}
\textstyle \bold{y}_{U_v} = \sum_{s = 1}^{S}\sum_{k=1}^{K_s} \boldsymbol{H}^H_{\mathcal{R}_s,\mathcal{U}_v} \
\mathfrak{y}_{R_s}\zeta_{U_v,k,s} a_{v,s}+ \boldsymbol{z}_{\mathcal{U}_v},
\end{equation}
که $\mathfrak{y}_{R_s} = \boldsymbol{W}_{\mathcal{R}_s,\mathcal{U}_v}\boldsymbol{P}_{U_v}^{\frac{1}{2}}\boldsymbol{x}_{\mathcal{U}_v}+ \boldsymbol{q}_{\mathcal{R}_s}$
و 
$\boldsymbol{x}_{ \mathcal{U}_v} = [x_{ u_{(v,1)}},...,x_{ u_{(v,\mathcal{U}_v)}}]^T \in \mathbb{C}^{{R}_s } $
نشان دهنده ی بردار سمبل ارسالی کاربران سرویس $v$ می باشد.
$\boldsymbol{z}_{U_v}$
نویز گوشی جمع شونده است و
$\boldsymbol{z_{U_v}} \backsim \mathcal{N}(0,N_0\boldsymbol{I}_{{U}_v})$
.
همچنین
$N_0$
توان نویز می باشد.
علاوه بر این
$\boldsymbol{q}_{R_s} \in \mathbb{C}^{{R}_s }  $
نشان دهنده ی نویز کوانتیزاسیون می باشد که از فشرده سازی سیگنال  در واحد توزیع شده بدست آمده است.
$\boldsymbol{P}_{U_v} = \diag{(p_{u_{(v,1)}}, ..., p_{u_{(v,\mathcal{U}_v)}})}$.
همچنین در اینجا، 
$\zeta_{k,s}^{U_v} \delequal \{\zeta_{k,s}^{u(v,1)},\zeta_{k,s}^{u(v,2)},...,\zeta_{k,s}^{u(v,N_{U_v})}\}$
و 
$\zeta_{k,s}^{u(v,i)} \in \{0,1\}$
پارامتر باینری می باشد که نشان دهنده ی این است که $i$ امین کابر در $v$امین سرویس امکان ارسال سیگنال خود را از طریق 
\lr{PRB}
$k$
ام دارد یا نه، در ضمن این \lr{PRB} 
 متعلق به برش $s$ ام می باشد و یا نه.
 $\boldsymbol{H}_{\mathcal{R}_s,\mathcal{U}_v}=\left[\boldsymbol{h}_{\mathcal{R}_s,u_{(v,1)}},\ldots,\boldsymbol{h}_{\mathcal{R}_s,v_{(v,\mathcal{U}_v)}}\right]^T  \in \mathbb{C}^{{R}_s\times {U}_v }$
نشان دهنده ی ماتریس کانال بین دسته واحد رادیویی 
 $\mathcal{R}_s$
 به دسته 
 $\mathcal{U}_v$
 کاربران می باشد.
بردار کانال بین $s$امین برش و $i$امین کابر در $v$امین سرویس $\boldsymbol{h}_{\mathcal{R}_s,u_{(v,i)}}\in \mathbb{C}^{{R}_s}$ به صورت زیر نشان داده شده است 
\begin{equation}
\boldsymbol{h}_{\mathcal{R}_s,u_{(s,i)}} = \boldsymbol{\beta}^\frac{1}{2}_{\mathcal{R}_s,u_{(v,i)}} \boldsymbol{g}_{\mathcal{R}_s,u_{(v,i)}},
\end{equation} 
که در اینجا 
$\boldsymbol{g}_{\mathcal{R}_s,u_{(v,i)}} \backsim \mathcal{N}(0,N_0\boldsymbol{I}_{\mathcal{U}_v})$
نشان دهنده ی بردار کانال فیدینگ سریع و تخت می باشد و
 $\boldsymbol{\beta}_{\mathcal{R}_s,u_{(v,i)}}=\text{diag}(b_{r_{(s,1),u_{(v,i)}}},\ldots,b_{r_{(s,\mathcal{R}_s),u_{(v,i)}}})$
 نشان دهنده ی ماتریس فیدینگ مقیاس بزرگ می باشد.
در اینجا فرض بر این است که اطلاعات حالت کانال \lr{CSI}، به صورت کامل می باشد.\newline
 $\boldsymbol{W}_{\mathcal{R}_s,\mathcal{U}_v} = [\boldsymbol{w}_{\mathcal{R}_s,u(v,1)},...,\boldsymbol{w}_{\mathcal{R}_s,u(v,U_v)}] \in \mathbb{C}^{{R}_s\times U_v} $
 بردار بیم فرمینگ \lr{zero forcing}
  می باشد که برای مینیمم کردن تداخل می باشد و بدین صورت است
\begin{equation}
\textstyle \boldsymbol{W}_{\mathcal{R}_s,\mathcal{U}_v} = \boldsymbol{H}_{\mathcal{R}_s,\mathcal{U}_v}(\boldsymbol{H}_{\mathcal{R}_s,\mathcal{U}_v}^H \boldsymbol{H}_{\mathcal{R}_s,\mathcal{U}_v})^{-1}.
\end{equation}  
توان تداخلی کابر $i$ام به سرویس $v$ام به صورت زیر بیان می شود
\begin{equation}
\begin{split}
 I_{u_{(v,i)}} &=
 \underbrace{\sum_{s=1}^{S}\sum_{n=1}^{S}\sum_{\substack{l=1 \\ l\neq i}}^{{U}_v} \gamma_{1}  p_{u_{(v,l)}}a_{v,s}\zeta_{u_(v,i),n,s}\zeta_{u_(v,l),n,s}}_{\text{(intra-service interference)}}\\
&+ \underbrace{\sum_{\substack{y=1 \\ l\neq v}}^{V}\sum_{s=1}^{S}\sum_{n=1}^{S}\sum_{l=1}^{{U}_y} \gamma_{2}  p_{u_{(y,l)}}a_{y,s} \zeta_{u_(v,i),n,s}\zeta_{u_(y,l),n,s}}_{\text{(inter-service interference)}}\\
&+\underbrace{ \sum_{s=1}^{S} \sum_{j=1}^{{R}_s} {\sigma_q}_{r_{(s,j)}}^2 |\boldsymbol{h}_{r_{(s,j)}, u_{(v,i)}}|^2 a_{v,s}}_{\text{(quantization noise interference)}},
\end{split}
\end{equation}
که 
$\gamma_{1} =|\boldsymbol{h}_{\mathcal{R}_s, u_{(v,i)}}^H \boldsymbol{w}_{\mathcal{R}_{s},u_{(v,l)}}|^2$
و 
$\gamma_{2} =|\boldsymbol{h}_{\mathcal{R}_s, u_{(v,i)}}^H \boldsymbol{w}_{\mathcal{R}_{s},u_{(y,l)}}|^2$.
همچنین 

${\sigma_q}_{r_{(s,j)}}$
واریانس نویز کوانتیزاسیون
$j$
امین 
واحد رادیویی در برش $s$ می باشد.
سیگنال تداخلی برای هر کاربر از سیگنالهای کاربرانی بدست می آید که از \lr{PRB} مشترکی استفاده نموده اند.
درصورت قرار دادن $P_{max}$
به جای 
$p_{u_{(v,l)}}$
و 
$p_{u_{(y,l)}}$
باند بالایی  
$\bar{I}_{u_{(v,i)}}$
برای 
$I_{u_{(v,i)}}$
بدست می آید
بنابراین،
$\bar{\mathcal{R}}_{u_{(v,i)}} \forall v , \forall i$ 
از قرار گرفتن 
$\bar{I}_{u_{(v,i)}}$
به جای 
$I_{u_{(v,i)}}$
در رابطه ی 
\eqref{eq1} و \eqref{eq2}
بدست می آید.
\newline
فرض کنید $\bar{p}_{r_{(s,j)}}$
نشان دهنده ی سیگنال ارسالی از $j$ امین واحد رادیویی در $s$ امین برش می باشد.
از رابطه ی \eqref{eq3} داریم
\begin{equation}
\bar{p}_{r_{(s,j)}} = \sum_{v=1}^{V}\boldsymbol{w}_{r_{(s,j)},\mathcal{U}_{v}} \boldsymbol{P}_{\mathcal{U}_v}^{\frac{1}{2}} \boldsymbol{P}_{\mathcal{U}_v}^{H \frac{1}{2}}   \boldsymbol{w}_{r_{(s,j)},\mathcal{U}_{v}}^H a_{v,s} + \sigma_{q_{r(s,j)}}^2.
\end{equation}
در این صورت نرخ کاربران در لینک \lr{fronthaul} بین $j$امین واحد رادیویی در برش $s$ام با واحد توزیع شده ی موجود در این برش، بدین صورت می باشد  \cite{simeone2016cloud, 1111}
\begin{equation}
C_{R_{(s,j)}} = \log{(1+\sum_{v=1}^{V}\frac{w_{r_{(s,j)},\mathcal{D}_{s}} \boldsymbol{P}_{\mathcal{U}_v}^{\frac{1}{2}} \boldsymbol{P}_{\mathcal{U}_v}^{H \frac{1}{2}}   w_{r_{(s,j)},\mathcal{U}_{v}}^H a_{v,s}}{ \sigma_{q_{r(s,j)}}^2})},
\end{equation}
که در اینجا 
$a_{v,s}$
متغیر باینری است که نشان دهنده ی این است که برش $s$ام به سرویس $v$ خدمات رسانی می کند یا نه.
\subsection{میانگین تاخیر}
فرض کنید ورود بسته های کاربران، فرآیند پوآسون با نرخ ورود 
$\lambda_{u(v,i)}$
برای $i$امین کاربر در سرویس $v$ ام می باشد.
بنابراین، در لایه ی واحد مرکزی (\lr{CU})، میانگین نرخ ورود داده ی کاربری که از خدمات برش $s$ استفاده می نماید 
$\alpha_{s_1} = \sum_{v=1}^{V}\sum_{u=2}^{U_v}a_{v,s}\lambda_{u(v,i)}$
می باشد. 
همچنین، میانگین نرخ داده ی ورودی در لایه ی \lr{DU}، تقریبا مساوی میانگین نرخ داده ی ورودی لایه ی اول 
$\alpha_{s} =\alpha_{s_1} \approx \alpha_{s_2}$
می باشد.
میانگین نرخ داده ی ورودی در لایه ی \lr{DU}، تقریبا برابر میانگین نرخ داده ی ورودی در لایه ی \lr{CU} می باشد $\alpha_{s} =\alpha_{s_1} \approx \alpha_{s_2}$.
در اینجا فرض بر این است کهدر هر لایه متعادل کننده ی ترافیک موجود است که ترافیک ورودی را به طور مساوی بین \lr{VNF} ها تقسیم می نماید\cite{frdl,luong2018novel,luong2018novel1}.
فرض کنید پردازش باند پایه هر \lr{VNF}، بوسیله ی پردازش صف \lr{M/M/1} نشان داده می شود.
هر بسته بوسیله ی یکی از \lr{VNF}های برش شبکه، پردازش می شود.
بنابراین، میانگین تاخیر برش $s$ در لایه ی اول و دوم با استفاده از مدل \lr{M/M.1} به این صورت نشان داده می شود
\begin{equation}
\begin{split}
d_{s_1} &= \frac{1}{\mu_1 - \alpha_{s}/{M_{s,1}}},\\
d_{s_2} &= \frac{1}{\mu_2 - \alpha_{s}/{M_{s,2}}}.
\end{split}
\end{equation}
در اینجا
$1/\mu_1$ و $1/\mu_2$
میانگین زمان سرویس دهی در لایه ی اول و دوم به ترتیب می باشند.
$\alpha_{s}$
نرخ ورودی است که توسط متعادل کننده ی ترافیک به طور مساوی بین \lr{VNF} ها تقسیم می شود.
نرخ ورودی هر \lr{VNF} در هر لایه از برش \lr{s}، $\alpha_{s}/{M_{s,i}}$ $ i \in \{1,2\}$ می باشد.
$d_{s_{tr}}$
تاخیر ارسال برای برش $s$ در لینک وایرلس می باشد.
نرخ داده ی ورودی لینک وایرلس برابر نرخ داده ی ورودی متعادل کننده ی ترافیک برای هر برش است
\cite{frdl}.
همچنین زمان سرویس برای صف ارسال در هر برش $s$ دارای توزیع نمایی با میانگین $1/(R_{{tot}_s})$
است و می توان به صورت صف \lr{M/M/1} مدل کرد  
\cite{frdl,luong2018novel,luong2018novel1,guo2016exploiting}.
بنابراین میانگین تاخیر لایه ی ارسال بدین صورت است
\begin{equation}
 d_{s_{tr}} = \frac{1}{R_{{tot}_s} - \alpha_{s}};
\end{equation}
 $R_{{tot}_s} =  \sum_{v=1}^{V}\sum_{u=2}^{U_v}a_{v,s}R_{u(v,i)}$ 
 کل نرخ قابل دسترس در هر برش می باشد که به سرویس خاص، تخصیص داده است.
میانگین تاخیر در هر برش نیز بدین صورت است
\begin{equation}
D_{s} = d_{s_1} + d_{s_2} + d_{s_{tr}} \forall s.
\end{equation}